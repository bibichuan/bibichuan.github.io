<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>目标检测之数据训练</title>
    <!-- 页面描述 -->
<meta name="description" content=""/>
<!-- 页面关键词 -->
<meta name="keywords" content=""/>
<!-- 网页作者 -->
<meta name="author" content="bibichuan, ibibichuan@gmail.com"/>
<!-- 搜索引擎抓取 -->
<meta name="robots" content="index,follow"/>

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>

<!--禁止百度转码-->
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<!--启用WebApp全屏模式-->
<meta name="apple-mobile-web-app-capable" content="yes" />
<!--禁止数字自动识别为电话号码-->
<meta name="format-detection" content="telephone=no" />
<!--忽略识别邮箱-->
<meta name="format-detection" content="email=no" />
<!--360强制谷歌内核-->
<meta name="renderer" content="webkit"> 

<link rel="icon" href="/images/favicon.ico">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1022896_nclaqhxyt.css">

<link href="/css/main.css" rel="stylesheet" type="text/css" />

<!-- 谷歌广告 -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8382618401389723"></script>


<script type="text/javascript" id="hexo.configurations">
  var BTheme = window.BTheme ||{};
  var CONFIG = {
    root: '/'
  };
</script>

<!--百度统计-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ee4ff785c4c68fa9a0ea17241e0574ea";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!--谷歌统计-->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G4HPTST8XX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-G4HPTST8XX');
</script>

    
    
        
    
        
            
            
            <link href="/lib/layui/css/layui.css" rel="stylesheet" type="text/css" />
        
    

    
        
    

    
        
    


    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.6/dist/jquery.fancybox.min.css" />
<link rel="stylesheet" type="text/css" href="/lib/share/style/css/ishare.css">

<meta name="generator" content="Hexo 5.4.2"></head>
<body class="main">

    <header id="header" class="header layui-fluid">
        <div class="header-inner layui-row"><div class="header-wrap">
    <div class="logo_wrap">
        <a href="/"><img src="/images/logo.png"></a>
    </div>
    <div class='search-warp'>
  <div class="search">
    <input class="search-ipt" placeholder="请输入搜索内容"/>
    <div class="search-btn clear"><i class="iconfont icon-guanbi"></i></div>
    <div class="search-btn find"><i class="iconfont icon-sousuo"></i></div>
  </div>
  <div class="result">
    <ul class="result-content"></ul>
  </div>
</div>
    <div class="icon-menu"><i class="iconfont icon-m_menu"></i></div>
    <nav class="site-nav">
        <ul class="menu layui-nav">
            
            
            <li class="menu-item layui-nav-item">
                <a href="/" rel="section">
                    <i class="iconfont icon-home"></i>首页<i class="iconfont icon-header-mobile icon-right"></i>
                </a>
            </li>
            
            

            
            

            
            
                
                
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/%E6%9D%82%E6%96%87/">
                                    杂文
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Python/">
                                    Python
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Gis/">
                                    Gis
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Asp/">
                                    Asp
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/%E8%BD%AF%E4%BB%B6/">
                                    软件
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                
                <li class="more menu-item layui-nav-item">
                    
                    <a href="javascript:;" class="menu-more">
                        更多分类
                        <i class="iconfont icon-header-mobile icon-sidemenu"></i>
                    </a>
                    
                    <dl class="layui-nav-child">
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Java/">
                                            Java
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%89%8D%E7%AB%AF/">
                                            前端
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Javascript/">
                                            Javascript
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">
                                            数据库
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                                            操作系统
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Nodejs/">
                                            Nodejs
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">
                                            大数据
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1/">
                                            后台服务
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E9%9A%8F%E7%AC%94/">
                                            随笔
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                            机器学习
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%85%B6%E4%BB%96/">
                                            其他
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                    </dl>
                </li>
            
        </ul>
    </nav>
</div></div>
    </header>
    
    <main class="main-content layui-fluid" id="main-content">
      <div class="main-inner">
        
  <div class="layui-row layui-col-space15">
    <div class="layui-col-xs12 layui-col-sm10 layui-col-sm-offset1 layui-col-md6 layui-col-md-offset2 layui-col-lg6 layui-col-lg-offset2">
        <div class="container post_wrap">
          <div class="post">
            <div class="article">
              <h1 class="title">目标检测之数据训练</h1>
              <div class="author">
                <span class="tag">标签：
                  

                  
                    无
                  
                </span>
                <span class="tag">分类：
                  

                  
                    
                    
                      
                      
                      <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
                    
                  
                </span>
                <span class='tag'>
                  创建时间：2024-09-06 03:51:23
                </span>
                <span class='tag'>
                  更新时间：2025-04-28 14:37:41
                </span>
              </div>
              <div class="content">
                <html><head></head><body><h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h1><p>对搜集到的数据进行标注之后，就可以进行数据训练了。</p>
<h1 id="2-数据划分"><a href="#2-数据划分" class="headerlink" title="2.数据划分"></a>2.数据划分</h1><p>如果使用 label studio 进行的标注，可能还需要对数据集进行划分，划分为 train（训练集）、test（测试集）和 val（验证集）。在data目录下划分数据集，通常将数据集划分为训练集（70%）、验证集（20%）和测试集（10%）。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将图片和标注数据按比例切分为 训练集和测试集</span></span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 检查文件夹是否存在</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mkdir</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        os.makedirs(path)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">image_dir, txt_dir, save_dir</span>):</span><br><span class="line">    <span class="comment"># 创建文件夹</span></span><br><span class="line">    mkdir(save_dir)</span><br><span class="line">    images_dir = os.path.join(save_dir, <span class="string">'images'</span>)</span><br><span class="line">    labels_dir = os.path.join(save_dir, <span class="string">'labels'</span>)</span><br><span class="line"> </span><br><span class="line">    img_train_path = os.path.join(images_dir, <span class="string">'train'</span>)</span><br><span class="line">    img_test_path = os.path.join(images_dir, <span class="string">'test'</span>)</span><br><span class="line">    img_val_path = os.path.join(images_dir, <span class="string">'val'</span>)</span><br><span class="line"> </span><br><span class="line">    label_train_path = os.path.join(labels_dir, <span class="string">'train'</span>)</span><br><span class="line">    label_test_path = os.path.join(labels_dir, <span class="string">'test'</span>)</span><br><span class="line">    label_val_path = os.path.join(labels_dir, <span class="string">'val'</span>)</span><br><span class="line"> </span><br><span class="line">    mkdir(images_dir);</span><br><span class="line">    mkdir(labels_dir);</span><br><span class="line">    mkdir(img_train_path);</span><br><span class="line">    mkdir(img_test_path);</span><br><span class="line">    mkdir(img_val_path);</span><br><span class="line">    mkdir(label_train_path);</span><br><span class="line">    mkdir(label_test_path);</span><br><span class="line">    mkdir(label_val_path);</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 数据集划分比例，训练集75%，验证集15%，测试集15%，按需修改</span></span><br><span class="line">    train_percent = <span class="number">0.8</span></span><br><span class="line">    val_percent = <span class="number">0.1</span></span><br><span class="line">    test_percent = <span class="number">0.1</span></span><br><span class="line"> </span><br><span class="line">    total_txt = os.listdir(txt_dir)</span><br><span class="line">    num_txt = <span class="built_in">len</span>(total_txt)</span><br><span class="line">    list_all_txt = <span class="built_in">range</span>(num_txt)  <span class="comment"># 范围 range(0, num)</span></span><br><span class="line"> </span><br><span class="line">    num_train = <span class="built_in">int</span>(num_txt * train_percent)</span><br><span class="line">    num_val = <span class="built_in">int</span>(num_txt * val_percent)</span><br><span class="line">    num_test = num_txt - num_train - num_val</span><br><span class="line"> </span><br><span class="line">    train = random.sample(list_all_txt, num_train)</span><br><span class="line">    <span class="comment"># 在全部数据集中取出train</span></span><br><span class="line">    val_test = [i <span class="keyword">for</span> i <span class="keyword">in</span> list_all_txt <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> train]</span><br><span class="line">    <span class="comment"># 再从val_test取出num_val个元素，val_test剩下的元素就是test</span></span><br><span class="line">    val = random.sample(val_test, num_val)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"训练集数目：{}, 验证集数目：{},测试集数目：{}"</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(train), <span class="built_in">len</span>(val), <span class="built_in">len</span>(val_test) - <span class="built_in">len</span>(val)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list_all_txt:</span><br><span class="line">        name = total_txt[i][:-<span class="number">4</span>]</span><br><span class="line"> </span><br><span class="line">        srcImage = os.path.join(image_dir, name + <span class="string">'.jpg'</span>)</span><br><span class="line">        srcLabel = os.path.join(txt_dir, name + <span class="string">'.txt'</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> train:</span><br><span class="line">            dst_train_Image = os.path.join(img_train_path, name + <span class="string">'.jpg'</span>)</span><br><span class="line">            dst_train_Label = os.path.join(label_train_path, name + <span class="string">'.txt'</span>)</span><br><span class="line">            shutil.copyfile(srcImage, dst_train_Image)</span><br><span class="line">            shutil.copyfile(srcLabel, dst_train_Label)</span><br><span class="line">        <span class="keyword">elif</span> i <span class="keyword">in</span> val:</span><br><span class="line">            dst_val_Image = os.path.join(img_val_path, name + <span class="string">'.jpg'</span>)</span><br><span class="line">            dst_val_Label = os.path.join(label_val_path, name + <span class="string">'.txt'</span>)</span><br><span class="line">            shutil.copyfile(srcImage, dst_val_Image)</span><br><span class="line">            shutil.copyfile(srcLabel, dst_val_Label)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dst_test_Image = os.path.join(img_test_path, name + <span class="string">'.jpg'</span>)</span><br><span class="line">            dst_test_Label = os.path.join(label_test_path, name + <span class="string">'.txt'</span>)</span><br><span class="line">            shutil.copyfile(srcImage, dst_test_Image)</span><br><span class="line">            shutil.copyfile(srcLabel, dst_test_Label)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    python split_datasets.py --image-dir my_datasets/color_rings/imgs --txt-dir my_datasets/color_rings/txts --save-dir my_datasets/color_rings/train_data</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">'split datasets to train,val,test params'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--image-dir'</span>, <span class="built_in">type</span>=<span class="built_in">str</span>,default=<span class="string">r'D:\zlc\gitee\yolov8\data\yolov8\images'</span>, <span class="built_in">help</span>=<span class="string">'image path dir'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--txt-dir'</span>, <span class="built_in">type</span>=<span class="built_in">str</span>,default=<span class="string">r'D:\zlc\gitee\yolov8\data\yolov8\labels'</span> , <span class="built_in">help</span>=<span class="string">'txt path dir'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--save-dir'</span>, default=<span class="string">r'D:\zlc\gitee\yolov8\data\yolov8\split'</span>,<span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">'save dir'</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    image_dir = args.image_dir</span><br><span class="line">    txt_dir = args.txt_dir</span><br><span class="line">    save_dir = args.save_dir</span><br><span class="line"> </span><br><span class="line">    main(image_dir, txt_dir, save_dir)</span><br></pre></td></tr></tbody></table></figure>

<p>最后形成了如下文件夹</p>
<img src="/images/loadimg.png" data-original="/posts/9b3c91c2/train_1.png" lay-src="/posts/9b3c91c2/train_1.png" class="" title="训练">


<div class="reference">参考文章:<br>【1】.<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Terrypython/p/18175080">YOLOV8训练自定义数据集 </a> 1.将标注数据按照类别划分到不同的文件目录;2.按照比例划分训练集与验证集;3.数据集按照既定格式进行整理;4.装ultralytics包;5.开始训练;<br>【2】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51530640/article/details/129975257">YOLOv8实例分割训练自己的数据集保姆级教程</a> 这里有数据分割的代码，还挺好用的。</div>
<h1 id="3-新建配置文件"><a href="#3-新建配置文件" class="headerlink" title="3.新建配置文件"></a>3.新建配置文件</h1><p>在 data 文件夹下新建一个数据加载配置文件 smoke.yaml</p>
<figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">train:</span> <span class="string">/home/mango/ultralytics/data/images/train</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">/home/mango/ultralytics/data/images/val</span></span><br><span class="line"><span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># class names</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">'smoke<span class="char escape_">''</span>]</span></span><br></pre></td></tr></tbody></table></figure>

<p>这里要说明的是，如果有多个类，那么names的配置需要和yolo的 classes.txt 或者 notes.json 里面的类别顺序一致。</p>
<h1 id="3-训练"><a href="#3-训练" class="headerlink" title="3.训练"></a>3.训练</h1><p>训练模型有四种方式,也可以说是三种，第四种和第三种其实一样的。考虑到命令行模式下下载模型可能有点慢，所以先在官方仓库下载好模型，并放入新建的 weights （文件路径：/home/mango/ultralytics/weights）目录下。</p>
<ul>
<li>（1）参数重写<br>使用命令行执行命令,可以提前下载 yolov8n.pt 模型文件，也可以不下载，如果没有下载的话，或者指定目录的pt文件不存在，会自动下载<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=train model=yolov8n.pt data=data/yolov8/smoke.yml batch=4 epochs=100 imgsz=640 workers=16 device=0</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">以上参数解释如下：</span><br><span class="line">task：选择任务类型，可选[<span class="string">'detect'</span>, <span class="string">'segment'</span>, <span class="string">'classify'</span>, <span class="string">'init'</span>]</span><br><span class="line">mode: 选择是训练、验证还是预测的任务蕾西 可选[<span class="string">'train'</span>, <span class="string">'val'</span>, <span class="string">'predict'</span>]</span><br><span class="line">model: 选择yolov8不同的模型配置文件，可选yolov8s.yaml、yolov8m.yaml、yolov8l.yaml、yolov8x.yaml</span><br><span class="line">data: 选择生成的数据集配置文件</span><br><span class="line">epochs：指的就是训练过程中整个数据集将被迭代多少次,显卡不行你就调小点。</span><br><span class="line">batch：一次看完多少张图片才进行权重更新，梯度下降的mini-batch,显卡不行你就调小点。</span><br><span class="line"></span><br><span class="line">- （2）重写配置文件</span><br><span class="line">新建配置文件，或者到 ultralytics/yolo/cfg/default.yaml 复制即可，或者使用命令： yolo copy-cfg， 它会自动生成一个 default_copy.yaml (目录地址：/home/mango/ultralytics/default_copy.yaml)，根据自身需求，修改相应参数，例如：修改 model、data、epochs、batch</span><br><span class="line">```yml</span><br><span class="line">model: weights/yolov8n.pt <span class="comment"># path to model file, i.e. yolov8n.pt, yolov8n.yaml</span></span><br><span class="line">data: data/person.yaml <span class="comment"># path to data file, i.e. coco128.yaml</span></span><br><span class="line">epochs: 20  <span class="comment"># number of epochs to train for</span></span><br><span class="line">batch: 8  <span class="comment"># number of images per batch (-1 for AutoBatch)</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>然后在终端输入下列代码行命令即可开始训练，还可以使用 yolo cfg=default_copy.yaml imgsz=320 batch=8 的方式修改 imgz、batch 等参数信息。</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo cfg=default_copy.yaml</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>（3）自定义 train.py 文件，执行训练</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from ultralytics import YOLO</span><br><span class="line"><span class="comment"># 加载模型</span></span><br><span class="line"><span class="comment"># model = YOLO("yolov8n.yaml")  # 从头开始构建新模型</span></span><br><span class="line">model = YOLO(<span class="string">"weights/yolov8n.pt"</span>)  <span class="comment"># 加载预训练模型（推荐用于训练）</span></span><br><span class="line"><span class="comment"># Use the model</span></span><br><span class="line">results = model.train(data=<span class="string">"data/person.yaml"</span>, epochs=20, batch=8)  <span class="comment"># 训练模型</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>(4) 官方提供的 train.py 文件<br>这个和第三种其实一样，只不过是官方已经提供了训练脚本了，进入 ultralytics/yolo 目录下，复制 person.yaml、yolov8n.pt 到 /ultralytics/yolo/v8/detect 目录，修改 ultralytics/yolo/cfg/default.yaml 的 model、data 路径及其他参数信息</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<div class="reference">参考文章:<br>【1】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40716944/article/details/128648001">YOLOv8训练自己的数据集(超详细)</a><br>【2】.<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaocer/p/17911747.html">基于YOLOv8训练自定义数据集</a> 这篇文章用的是 voc 转为了 yolo 格式，但是有一个地方让我非常的困惑，就是在配置文件这个步骤里面，他新建一个mydata.yaml文件，然后修改了，接着选择了一个yolov8x.yaml模型，也修改了里面的配置文件，但是在接下去的模型训练步骤中，他又重新下载了预训练模型，然后没有改，直接就输入命令进行训练了。那么在配置文件中，修改的yolov8x.yaml有什么意义呢？下载模型的意义又是什么呢？<br>【3】.<a target="_blank" rel="noopener" href="https://cloud.baidu.com/article/3357884">从零到一：使用YOLOv8训练自定义目标检测模型</a> 1.收集数据集;2.收集数据集;3.划分数据集;4.配置训练环境,编辑配置文件（如yolov8s.yaml），设置网络结构、训练轮次、学习率、优化器等参数,创建一个data.yaml文件，指定数据集路径、类别名称等信息。;5.训练模型;6.评估模型;7.模型部署与应用;<br>【4】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42166222/article/details/129391260">【YOLO】YOLOv8训练自定义数据集（4种方式）</a> 这里我赶紧写的还是挺清楚的</div>
<h1 id="8-训练参数"><a href="#8-训练参数" class="headerlink" title="8.训练参数"></a>8.训练参数</h1><p>我从官网摘录了全部的训练参数，方便查阅。</p>
<ul>
<li>model，指定用于训练的模型文件。接受 .pt 预训练模型或 .yaml 配置文件的路径。对于定义模型结构或初始化权重至关重要，默认：None</li>
<li>data，数据集配置文件的路径（例如，coco8.yaml）。该文件包含特定于数据集的参数，包括训练和验证数据的路径、类名称和类数量,默认：None</li>
<li>epochs，训练时期总数。每个时期代表对整个数据集的完整遍历。调整此值可能会影响训练持续时间和模型性能。训练数据集需要重复训练多少次, yolov5 推荐初始为 300 个, 而 yolov8推荐初始为500, 如果发现有过拟合overfit, 则适当减少, 如果没有overfit, 则增加到600、1200. 如果使用 CPU, 为了缩短时间epochs可从100开始试. 过拟合最优先的应对策略是增加验证集比例和增加验证集多样性。默认：100</li>
<li>time，最大训练时间（以小时为单位）。如果设置，这将覆盖 epochs 参数，允许训练在指定的持续时间后自动停止。对于时间有限的训练场景很有用，默认：None</li>
<li>patience，在提前停止训练之前等待验证指标没有改善的时期数。当性能达到稳定水平时停止训练，有助于防止过度拟合。为 EarlyStopping 的 epoch 数量, 默认为 patience=50 , 如果要禁用早停特性, 设置0即可。默认：100</li>
<li>batch，批大小，具有三种模式：设置为整数（例如，batch=16）、60% GPU 内存利用率的自动模式（batch=-1）或具有指定利用率的自动模式（batch=0.70），batch size 为一次前向传播送入模型的图片数量, 完成后将做反向传递, 进行weight/bias参数调整, batch size 取值必须为2的n次方, 最小值为2. 这个参数应使用硬件支持的最大 batch size, 比如64开始, 如果不爆内存/显存问题, 则增加到 128、256, batch size越大 batchNorm 效果越好, 精度越高。默认：16</li>
<li>imgsz，训练的目标图像大小。所有图像在输入模型之前都会调整为该尺寸。影响模型精度和计算复杂度。这个参数非常重要，用来将实际图像统一缩放到一个固定的尺寸送入到网络，imgsz 参数必须是 32 的倍数，train/val/test/predict 不要求有相同的原始图像尺寸, 但最好差异不要太大。通常 imgsz 越大效果也越好, 但这并不绝对, 如果被检查物非常小, img size 太大反而不行。采用较大 imgsz, 比较容易爆显存同时训练速度也会降低, 如果原始图像是3840<em>2160这样高清图像,最好还是设置 imgsz=1280, 这个数值应该是速度和准确性比较好的平衡点。通常设置 imgsz=640 是一个很好的选择, yolo会自动将我们的图像缩放到640</em>640的尺寸, 方法是:将图像的长边缩放到640, 图像的短边按照长边缩放的比例缩放, 如果不足640, 则在短边两侧自动padding黑色像素。yolov8 预训练模型基于 640 尺寸的图像训练, 如果我们的数据集为高清图像, 可以采用 yolov8 P6模型, 这个系列的模型文件分别为yolov8m6, yolov8l6, yolov8x6。默认：640</li>
<li>save，能够保存训练检查点和最终模型权重。对于恢复训练或模型部署很有用，默认：True</li>
<li>save_period，保存模型检查点的频率，以纪元指定。值为 -1 将禁用此功能。对于在长时间训练期间保存临时模型很有用，默认：-1</li>
<li>cache，启用在内存 (True/ram)、磁盘 (disk) 中缓存数据集图像，或禁用它 (False)。通过减少磁盘 I/O 来提高训练速度，但代价是增加内存使用量，默认：False</li>
<li>device，指定用于训练的计算设备：单个 GPU (device=0)、多个 GPU (device=0,1)、CPU (device=cpu) 或 Apple 芯片的 MPS (device=mps)，默认：None</li>
<li>workers，用于数据加载的工作线程数（如果是多 GPU 训练，则按 RANK 计算）。影响数据预处理和输入模型的速度，在多 GPU 设置中特别有用，默认：8</li>
<li>project，保存训练输出的项目目录的名称。允许组织存储不同的实验，默认：None</li>
<li>name，训练运行的名称。用于在项目文件夹中创建子目录，其中存储训练日志和输出，默认：None</li>
<li>exist_ok，如果为 True，则允许覆盖现有项目/名称目录。对于迭代实验很有用，无需手动清除以前的输出，默认：False</li>
<li>pretrained，确定是否从预训练模型开始训练。可以是布尔值或指向从中加载权重的特定模型的字符串路径。提高训练效率和模型性能，默认：True</li>
<li>optimizer，选择训练优化器。选项包括 SGD、Adam、AdamW、NAdam、RAdam、RMSProp 等，或者 auto 用于根据模型配置自动选择。影响收敛速度和稳定性，默认：‘auto’</li>
<li>verbose，在训练期间启用详细输出，提供详细的日志和进度更新。对于调试和密切监控训练过程很有用，默认：False</li>
<li>seed，设置训练的随机种子，确保使用相同配置运行时结果的可重复性，默认：0</li>
<li>deterministic，强制使用确定性算法，确保可重复性，但由于对非确定性算法的限制，可能会影响性能和速度，默认：True</li>
<li>single_cls，在训练期间将多类数据集中的所有类视为单个类。对于二元分类任务或关注对象存在而不是分类时很有用，默认：False</li>
<li>rect，启用矩形训练，优化批次组成以最小化填充。可以提高效率和速度，但可能会影响模型精度。yolo在进行训练之前总是会将图像按letterbox方式做resize, 所以缩放后的图像仍然保留原来真实的长宽比例. 如果rect设置为False(缺省), 表示yolo会统一将它们resize成一个正方形, 该取值适合原始图像宽高差异不大的情况; 如果rect=True, yolo resize的结果将是一个长方形而不是正方形, 比较适合原始图像宽高差异较大的情况, 在这种情况下, 如果仍然缩放到宽高相等, 图像中padding的区域就会很大, 浪费GPU算力, rect如果取值为True时候, imgsz参数应该同时设置宽高两个值。默认：False</li>
<li>cos_lr，利用余弦学习率调度程序，根据历元的余弦曲线调整学习率。有助于管理学习率以实现更好的收敛，默认：False</li>
<li>close_mosaic，在最后 N 个时期禁用马赛克数据增强，以在完成之前稳定训练。设置为 0 将禁用此功能，默认：10</li>
<li>resume，从上次保存的检查点恢复训练。自动加载模型权重、优化器状态和历元计数，无缝地继续训练，默认：False</li>
<li>amp，启用自动混合精度 (AMP) 训练，减少内存使用，并可能加快训练速度，同时对准确性的影响最小，默认：True</li>
<li>fraction，指定用于训练的数据集的比例。允许对完整数据集的子集进行训练，这对于实验或资源有限时很有用，默认：1.0</li>
<li>profile，在训练期间启用 ONNX 和 TensorRT 速度分析，对于优化模型部署非常有用，默认：False</li>
<li>freeze，通过索引冻结模型的前 N ​​层或指定层，减少可训练参数的数量。对于微调或迁移学习很有用，默认：None</li>
<li>lr0，初始学习率（即SGD=1E-2，Adam=1E-3）。调整该值对于优化过程至关重要，会影响模型权重更新的速度。学习率是梯度下降的步长系数。默认：0.01</li>
<li>lrf，最终学习率作为初始学习率的一部分 = (lr0 * lrf)，与调度程序结合使用，随时间调整学习率，学习率是梯度下降的步长系数。默认：0.01</li>
<li>momentum，Adam 优化器的 SGD 或 beta1 动量因子，影响当前更新中过去梯度的合并，默认：0.937</li>
<li>weight_decay，L2 正则化项，惩罚大权重以防止过度拟合，默认：0.0005</li>
<li>warmup_epochs，学习率预热的纪元数，逐渐将学习率从低值增加到初始学习率，以在早期稳定训练，默认：3.0</li>
<li>warmup_momentum，预热阶段的初始动量，在预热期间逐渐调整到设定的动量，默认：0.8</li>
<li>warmup_bias_lr，预热阶段偏差参数的学习率，有助于稳定初始时期的模型训练，默认：0.1</li>
<li>box，损失函数中框损失分量的权重，影响准确预测边界框坐标的程度，默认：7.5</li>
<li>cls，总损失函数中分类损失的权重，影响正确类别预测相对于其他组件的重要性，默认：0.5</li>
<li>dfl，分布焦点损失的权重，在某些YOLO版本中用于细粒度分类，默认：1.5</li>
<li>pose，用于姿势估计训练的模型中姿势损失的权重，影响对准确预测姿势关键点的重视，默认：12.0</li>
<li>kobj，姿态估计模型中关键点客观性损失的权重，平衡检测置信度和姿态精度，默认：2.0</li>
<li>label_smoothing，对目标标签的混合应用标签平滑、软化硬标签以及标签上的均匀分布，可以提高泛化能力，默认：0.0</li>
<li>nbs，损失标准化的标称批量大小，默认：64</li>
<li>overlap_mask，确定分割掩码在训练期间是否应重叠，适用于实例分割任务，默认：True</li>
<li>mask_ratio，分割掩模的下采样率，影响训练期间使用的掩模的分辨率，默认：4</li>
<li>dropout，分类任务中正则化的丢弃率，通过在训练期间随机省略单元来防止过度拟合，0.0</li>
<li>val，在训练期间启用验证，允许在单独的数据集上定期评估模型性能，默认：True</li>
<li>plots，生成并保存训练和验证指标图以及预测示例，提供对模型性能和学习进度的可视化洞察，默认：False</li>
</ul>
<ul>
<li>train/val/test/predict，超参最好要一致, 不一致的参数有可能会引起predict显著变化</li>
<li>task，参数默认为 detect，可以传递 task 如：[detect、classify、segment]</li>
<li>mode，参数默认为train, train模式下默认包含 val, ，mode 有：[train、predict、val、export]</li>
</ul>
<div class="reference">参考文章:<br>【1】.<a target="_blank" rel="noopener" href="https://docs.ultralytics.com/modes/train/#multi-gpu-training">Train Settings</a> 训练参数设置<br>【2】.<a target="_blank" rel="noopener" href="https://www.cnblogs.com/harrychinese/p/17973306"> 机器视觉 - yolo 调参</a> 1.大小目标的分类；2.yolov8 模型文件。3.模型训练通用规则。4.yolov8 参数设置技巧。<br>【3】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42452134/article/details/135220703">超详细YOLOv8训练参数、说明详解</a> YOLOv8训练模式的一些显著特点：自动数据集下载、多GPU支持、超参数配置、可视化和监控。这里有训练参数的说明，可以进行相应的表格参考。</div>
<h1 id="9-结果分析"><a href="#9-结果分析" class="headerlink" title="9.结果分析"></a>9.结果分析</h1><p>开始的时候，我没有做过完整的一个训练，于是我就不太清楚，到底训练的结果在哪里呢？这个让我找了好多的资料。在很多的文章中，会提到一个 weights/best.pt ，我想应该就是这个最后的模型了吧。训练完成之后，会生成一个 detect/train3/weights/best.pt ，这个就可以作为相关配置。</p>
<ul>
<li><p>confusion_matrix_normalized.png和confusion_matrix.png<br>confusion_matrix_normalized.png和confusion_matrix.png表示各个类别对应的混淆矩阵，其中confusion_matrix_normalized.png表示归一化后的混淆矩阵，confusion_matrix.png表示各类别数值对应的混淆矩阵。混淆矩阵是对分类问题预测结果的总结。使用计数值汇总正确和不正确预测的数量，并按每个类进行细分，显示了分类模型进行预测时会对哪一部分产生混淆。通过这个矩阵可以方便地看出机器是否将两个不同的类混淆了，把一个类错认成了另一个。</p>
</li>
<li><p>P_curve.png（准确率曲线）<br>表示准确率precision和置信度confidence的关系图，其中细线代表每个类别的精度曲线，粗线代表所有类别平均精度曲线。当判定概率超过置信度阈值时，各个类别识别的准确率。当置信度越大时，类别检测越准确，但是这样就有可能漏掉一些判定概率较低的真实样本。<br>意思就是，当我设置置信度为某一数值的时候，各个类别识别的准确率。可以看到，当置信度越大的时候，类别检测的越准确。这也很好理解，只有confidence很大，才被判断是某一类别。但也很好想到，这样的话，会漏检一些置信度低的类别。</p>
</li>
<li><p>R_curve.png（召回率曲线）<br>表示召回率recall和置信度confidence之间的关系，其中细线代表每个类别的召回率曲线，粗线代表所有类别平均召回率曲线。recall（召回率）表示真实为positive的准确率，即正样本有多少被找出来了（召回了多少）。<br>当置信度越小的时候，类别检测的越全面（不容易被漏掉，但容易误判）。</p>
</li>
<li><p>PR_curve.png（PR曲线）<br>PR曲线表示体现精确率和召回率的关系,其中细线代表每个类别的PR曲线，粗线代表所有类别平均PR曲线。P代表的是precision（精准率），R代表的是recall（召回率）。一般情况下，将recall设置为横坐标，precision设置为纵坐标。PR曲线下围成的面积即AP，所有类别AP平均值即mAP.因此我们希望：在准确率很高的前提下，尽可能的检测到全部的类别。因此希望我们的曲线接近(1,1)，即希望PR曲线的面积尽可能接近1。如果PR图的其中的一个曲线A完全包住另一个学习器的曲线B，则可断言A的性能优于B，当A和B发生交叉时，可以根据曲线下方的面积大小来进行比较。一般训练结果主要观察精度和召回率波动情况（波动不是很大则训练效果较好）Precision和Recall往往是一对矛盾的性能度量指标；及一个的值越高另一个就低一点。</p>
</li>
<li><p>F1_curve.png（F1曲线）<br>表示是置信度confidence与F1之间的关系曲线。一般来说，置信度阈值（该样本被判定为某一类的概率阈值）较低的时候，很多置信度低的样本被认为是真，召回率高，精确率低；置信度阈值较高的时候，置信度高的样本才能被认为是真，类别检测的越准确，即精准率较大（只有confidence很大，才被判断是某一类别），所以前后两头的F1分数比较少。</p>
</li>
<li><p>val_batch0_labels与val_batch0_pred<br>val_batch0_labels.png表示验证集真实的标签情况示例。</p>
</li>
</ul>
<div class="reference">参考文章:<br>【1】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43752269/article/details/137261371">YOLOv8训练自定义数据集模型</a> data.yaml主要是保存训练数据集的目录，类别数，类别名，这里还提供了训练时的一些参数调整<br>【2】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45277161/article/details/131046636">yolov8模型训练结果分析以及如何评估yolov8模型训练的效果</a> 1.目标检测性能指标；2.混淆矩阵；3.精确率和召回率；4.损失函数；<br>【3】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42693842/article/details/136041335">YOLOv8 训练 预测 更改save输出位置 全网首发</a> 更改ultralytics库里的 yaml 文件: /ultralytics/yolo/cfg/default.yaml,添加字段:save_dir<br>【4】.<a target="_blank" rel="noopener" href="https://hub.baai.ac.cn/view/30092">YOLOv8 实现 任意目录下 命令行训练</a><br>【5】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42681787/article/details/135506530">如何使用YOLOV8训练自己的目标检测模型</a> model.train()函数可以指定的训练参数有很多,这里也列出来了。训练成功。经过一段时间等待之后，在目录下的runs文件夹下会自动生成训练过程记录，包含模型权重、混淆矩阵、PR曲线、loss曲线等。<br>【6】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43471945/article/details/134675557">YOLOv8训练好的pt文件如何用来预测</a><br>【7】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34717531/article/details/135016961">yolov8实战第二天——yolov8训练过程、结果分析（保姆式解读）</a><br>【8】.<a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/1536833">YOLOv8如何使用训练好的模型对验证集进行评估及评估参数详解</a></div>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><h2 id="1-Compile-with-TORCH-USE-CUDA-DSA-to-enable-device-side-assertions"><a href="#1-Compile-with-TORCH-USE-CUDA-DSA-to-enable-device-side-assertions" class="headerlink" title="1.Compile with TORCH_USE_CUDA_DSA to enable device-side assertions"></a>1.Compile with <code>TORCH_USE_CUDA_DSA</code> to enable device-side assertions</h2><p>在执行 yolov8 训练的时候，出现了这个问题。本来我的 batch 为64，后来我降到了16，也还是不行。而且我做其他的训练的时候，就不会出现这个问题。RuntimeError: CUDA error: device-side assert triggered CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect. For debugging consider passing CUDA_LAUNCH_BLOCKING=1 Compile with <code>TORCH_USE_CUDA_DSA</code> to enable device-side assertions.</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=train model=yolov8n.pt data=data/yolov8/smoke.yml batch=64 epochs=100 imgsz=640 workers=16 device=0</span><br></pre></td></tr></tbody></table></figure>

<p>【解决方案】<br>这个问题就是因为我标签里面其实是个2分类问题，最后在写配置文件的时候，我只写了一个类别，如下错误示范。</p>
<figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">train:</span> <span class="string">D:/zlc/gitee/yolov8/data/yolov8/split/images/train</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">D:/zlc/gitee/yolov8/data/yolov8/split/images/val</span></span><br><span class="line"><span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># class names</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">'soil'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>正确的配置</p>
<figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">2</span></span><br><span class="line"><span class="comment"># class names</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">'soil'</span>,<span class="string">'smoke'</span>]</span><br></pre></td></tr></tbody></table></figure>

<div class="reference">参考文章:<br>【1】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/lsb2002/article/details/134341417">conda环境下Compile with <code>TORCH_USE_CUDA_DSA</code> to enable device-side assertions问题解决</a><br>【2】.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37700257/article/details/124513572">解决RuntimeError: CUDA error: device-side assert triggeredCUDA kernel errors…CUDA_LAUNCH_BLOCKING=1</a> 这篇文章给了我解决方案</div></body></html>
              </div>
            </div>
          </div>
          <div class='post-footer'>
            <div>**本文已结束，感谢您的观看**</div>
            <div class="btn btn-pay">鼓励一下</div>
          </div>
          
            <div class="page">
              
              <section class="past-wrap">
                <section class="past">
                <p>往期推荐</p>
                </section>
              </section>
              <div class="post-nav">
                <div class="post-nav-next post-nav-item">
                  
                    <a href="/posts/72128d4d.html" rel="next" title="目标检测之数据预测">
                      <i class="iconfont icon-prev"></i> 目标检测之数据预测
                    </a>
                  
                </div>

                <span class="post-nav-divider"></span>

                <div class="post-nav-prev post-nav-item">
                  
                    <a href="/posts/b42e18f6.html" rel="prev" title="目标检测之数据标注">
                      目标检测之数据标注 <i class="iconfont icon-next"></i>
                    </a>
                  
                </div>
              </div>
            </div>
          
          
 <div class="comments" id="comments">
    <div id="disqus_thread">
        <noscript>
            不支持Javascript,那你还上啥网啊。
            <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript"></a>
        </noscript>
    </div>
</div>

      </div>
    </div>


    <div class="layui-col-md2 layui-col-lg2 layui-col-sm10 layui-col-xs12 catalogue-wrap">
        

<div class="catalogue-content">
    <div class="title">文章目录</div>
    <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">1.前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%88%92%E5%88%86"><span class="toc-number">2.</span> <span class="toc-text">2.数据划分</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%96%B0%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">3.新建配置文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E8%AE%AD%E7%BB%83"><span class="toc-number">4.</span> <span class="toc-text">3.训练</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E8%AE%AD%E7%BB%83%E5%8F%82%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">8.训练参数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90"><span class="toc-number">6.</span> <span class="toc-text">9.结果分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">7.</span> <span class="toc-text">问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Compile-with-TORCH-USE-CUDA-DSA-to-enable-device-side-assertions"><span class="toc-number">7.1.</span> <span class="toc-text">1.Compile with TORCH_USE_CUDA_DSA to enable device-side assertions</span></a></li></ol></li></ol>
    </div>
</div>


        <div class="sidecontent">

    

    <div class="side-panel side-sponsor">
        <div class="side-title one">小额赞助</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">本人提供免费与付费咨询服务，感谢您的支持！赞助请发邮件通知，方便公布您的善意！</div>
                <div class="content">
                    <img src="/images/pay.png" title="小额赞助"/>
                </div>
                
                
                <div class="donor_content">
                    
                        
                        <div class="donor-item">
                            <span class="name">**光</span>
                            <span class="money">3.01 元</span>
                        </div>
                    
                        
                        <div class="donor-item">
                            <span class="name">Sun</span>
                            <span class="money">3.00 元</span>
                        </div>
                    
                        
                        <div class="donor-item">
                            <span class="name">bibichuan</span>
                            <span class="money">3.00 元</span>
                        </div>
                    
                    <div class="donor_footer">
                        <span>捐赠者名单</span>
                        <span class="total">合计：9.01 元</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-ad side-panel">
        <div class="side-title two">微信公众号</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <img src="/images/wechat.png" title="公众号"/>
            </div>
        </div>
    </div>

    <div class="side-ad side-panel">
        <div class="side-title one">广告位</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">诚心邀请广大金主爸爸洽谈合作</div>
                <div class="detail">
                </div>
            </div>
        </div>
    </div>

    <div class="side-ask side-panel">
        
        <div class="side-title two">每日一省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">isNaN 和 Number.isNaN 函数的区别？</div>
                <div class="detail">
                    
                        <p>1.函数 isNaN 接收参数后，会尝试将这个参数转换为数值，任何不能被转换为数值的的值都会返回 true，因此非数字值传入也会返回 true ，会影响 NaN 的判断。</p>
                    
                        <p>2.函数 Number.isNaN 会首先判断传入参数是否为数字，如果是数字再继续判断是否为 NaN ，不会进行数据类型的转换，这种方法对于 NaN 的判断更为准确。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title three">每日二省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">为什么0.1+0.2 ! == 0.3，如何让其相等?</div>
                <div class="detail">
                     
                        <p>一个直接的解决方法就是设置一个误差范围，通常称为“机器精度”。对JavaScript来说，这个值通常为2-52，在ES6中，提供了Number.EPSILON属性，而它的值就是2-52，只要判断0.1+0.2-0.3是否小于Number.EPSILON，如果小于，就可以判断为0.1+0.2 ===0.3。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230#heading-8"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title three">每日三省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">== 操作符的强制类型转换规则？</div>
                <div class="detail">
                     
                        <p>1.首先会判断两者类型是否**相同，**相同的话就比较两者的大小。</p>
                    
                        <p>2.类型不相同的话，就会进行类型转换。</p>
                    
                        <p>3.会先判断是否在对比 null 和 undefined，是的话就会返回 true。</p>
                    
                        <p>4.判断两者类型是否为 string 和 number，是的话就会将字符串转换为 number。</p>
                    
                        <p>5.判断其中一方是否为 boolean，是的话就会把 boolean 转为 number 再进行判断。</p>
                    
                        <p>6.判断其中一方是否为 object 且另一方为 string、number 或者 symbol，是的话就会把 object 转为原始类型再进行判断。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230#heading-12"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title two">每日英语</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">Happiness is time precipitation, smile is the lonely sad.</div>
                <div class="detail">幸福是年华的沉淀，微笑是寂寞的悲伤。</div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2016</span>
                
                    <span class="side-footer-item side-button down" title="查看翻译">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                <span class="side-footer-item author">——— 美文</span>
            </div>
        </div>
    </div>

</div>
    </div>

  </div>
  <div class="side-tool">
    <div class="side-icon-wrap">
        <i class="iconfont icon-sidemenu"></i>
    </div>
    <ul class="side-tool-content">
        <li title="回到顶部" class="back-to-top side-tool-item">
            <a class="function-button"><i class="iconfont icon-backtop"></i></a>
        </li> 
        <li title="分享文章" class="side-share side-tool-item">
            <a class="function-button"><i class="iconfont icon-share"></i></a>
            <div class="iShare iShare-content"></div>
        </li>
        <li title="喜欢文章" class="side-like side-tool-item">
            <a class="function-button"><i class="iconfont icon-like"></i></a>
        </li>
         <li class="side-close" title="关闭侧边栏">
            <a class="function-button"><i class="iconfont icon-close"></i></a>
        </li>
    </ul>
</div>

      </div>
    </main>   
    
    <footer id="footer" class="footer layui-fluid">
      <div class="layui-row">
        <div class="container footer-inner">
          <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="footer-col">
  <div>温馨提示</div>
  <div><a href="/about" target="_self">关于作者</a></div>
  <div><a href="/archives">博客归档</a></div>
  <div>
    <span id="busuanzi_container_site_uv">
      访客数<span id="busuanzi_value_site_uv"></span>人次
    </span>
  </div>
</div>
<div class="footer-col">
  <div>友情链接</div>
  
  
  
  
    
        <div><a href="https://malagis.com" target="_blank">麻辣GIS</a></div>
    
  
    
        <div><a href="https://www.giserdqy.com" target="_blank">GIS开发者</a></div>
    
  
    
        <div><a href="https://earth.nullschool.net/zh-cn/" target="_blank">earth.nullschool</a></div>
    
  
    
        <div><a href="https://www.gisclouder.com/" target="_blank">码上GIS实现的热力图</a></div>
    
  
    
        <div><a href="http://www.cnblogs.com/naaoveGIS/" target="_blank">李晓辉的博客园</a></div>
    
  
    
        
          <div><a href="/links">更多</a></div>
          
        
    
  
    
        
    
  
    
        
    
  
    
        
    
  
  <div class="chain-msg">**注意：以上网站都没给钱**</div>
</div>
<div class="footer-col">
  <div>精彩推荐</div>
  
    <div><a href="/study">励志</a></div>
  
    <div><a href="/anime">动漫</a></div>
  
    <div><a href="/movie">电影</a></div>
  
    <div><a href="/tv">电视</a></div>
  
    <div><a href="/book">书籍</a></div>
  
</div>
<div class="footer-col">
  <div>开源项目</div>
  
    <div><a href="/"></a></div>
  
</div>
          
        </div>
      </div>
    </footer>

    


<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>

    
        
            
            
            <script type="text/javascript" src="/lib/layui/layui.js"></script>
        
    
        
    

    
        
            
            
                
            
            <script type="text/javascript" src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
        
    

    
        
            
            
            <script type="text/javascript" src="/lib/jquery.actual.min.js"></script>
        
    


    


  <script type="text/javascript" src="/js/src/utils.js?v="></script>



    
      <script type="text/javascript" src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearchLite.min.js"></script>
<script type="text/javascript">
  var client = algoliasearch('DM9LMZOGZE', '1c2739694b8acb4c4edab8ccb098d166');
  var index = client.initIndex('bibichuan');
  $(document).ready(function(){
    var $search=$(".header-wrap");
    var $searchbtn= $search.find(".find");
    var $ipt=$search.find(".search-ipt");
    var $resultClear=$search.find(".clear");
    var $result=$search.find(".result");
    // 加入layui
    layui.use('layer', function(){
      var layer = layui.layer;
      // 搜索按钮点击
      $searchbtn.on("click",function(){
        var text=$ipt.val();
        var $this=$(this);
        var $resultContent=$result.find(".result-content");
        if(text){
          var loadDialog=layer.load();
          if(!$this.hasClass("disabled")){
            $this.addClass("disabled");
            index.search(text, (err, { hits } = {}) => {
              layer.close(loadDialog); 

              $this.removeClass("disabled");
              var resultHtml="";
              // 命中
              if(hits.length>0){
                var count=hits.length;
                for(var i=0;i<count;i++){
                  var h=hits[i];
                  //根据返回值中_highlightResult来判断显示的内容。
                  var content=h.contentStripTruncate;
                  var _highlight=h._highlightResult;

                  var resultC="";
                  var hitType=""; // 命中的类型
                  //标题命中
                  if(_highlight.title&&!resultC){  
                    if(_highlight.title.matchLevel&&_highlight.title.matchLevel!='none'){
                      resultC=_highlight.title.value;
                      hitType="title";
                    }
                  }
                  //分类命中
                  if(_highlight.categories&&!resultC){ 
                    var arr=_highlight.categories;
                    if(arr instanceof Array){
                      var countTemp=arr.length;
                      for(var j=0;j<countTemp;j++){
                        var temp=arr[j];
                        if(temp.matchLevel&&temp.matchLevel!='none'){
                          resultC=temp.value;
                          hitType="categories";
                        }
                      }
                    }else{
                      if(arr.matchLevel&&arr.matchLevel!='none'){
                        resultC=arr.value;
                        hitType="categories";
                      }
                    }
                  }

                  //标签命中
                  if(_highlight.tags&&!resultC){ 
                    var arr=_highlight.tags;
                    if(arr instanceof Array){
                      var countTemp=arr.length;
                      for(var j=0;j<countTemp;j++){
                        var temp=arr[j];
                        if(temp.matchLevel&&temp.matchLevel!='none'){
                          resultC=temp.value;
                          hitType="tags";
                        }
                      }
                    }else{
                      if(arr.matchLevel&&arr.matchLevel!='none'){
                        resultC=arr.value;
                        hitType="tags";
                      }
                    }
                  }

                  // 内容命中
                  if(!resultC){ 
                    resultC=_highlight.contentStripTruncate.value;
                    hitType="contentStripTruncate";
                  }

                  //如果内容过长，则截断
                  if(resultC.length>50){
                    var index=resultC.indexOf('<em>');
                    var blockIndex=10;
                    if(index>=blockIndex){
                      index=index-blockIndex;
                    }else{
                      index=0;
                    }
                    resultC="..."+resultC.substring(index,index+20+blockIndex)+"...";
                  }
                  switch(hitType){
                    case "title":
                      resultC="标题："+resultC;
                      break;
                    case "categories":
                      resultC="分类："+resultC;
                      resultC+=" ("+h.contentStripTruncate.substring(0,40)+"...)";
                      break;
                    case "tags":
                      resultC="标签："+resultC;
                      resultC+=" ("+h.contentStripTruncate.substring(0,40)+"...)";
                      break;
                    case "contentStripTruncate":
                      resultC="内容："+resultC;
                      break;
                  }

                  resultHtml+='<li class="result-item" title="'+content+'"><a href="'+h.permalink+'">'+resultC+'</a></li>';
                }
                $(resultHtml).appendTo($resultContent.empty());
                $result.show();
                $resultClear.show();
              }else{
                var resultHtml='<li class="result-item" title="未找到相关内容"><a>未找到相关内容</a></li>';
                $(resultHtml).appendTo($resultContent.empty());
                $result.show();
                $resultClear.show();
              }
            });
          }
        }else{
          layer.msg("请输入搜索内容");
        }
      });
      // 删除输入内容
      $resultClear.on("click",function(){
        $result.hide();
        $resultClear.hide();
        //清空输入内容
        $ipt.val("");
      });
      // 监听确定事件
      $ipt.keydown(function(e){
        if(e.keyCode==13){
          $searchbtn.click();
        }
      });
    });              
  
  });
</script>
    

    
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.6/dist/jquery.fancybox.min.js"></script>
<script src="/js/src/post/post.js">></script>

  

  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'https://bibichuan.github.io/posts/9b3c91c2.html';
      this.page.identifier = 'posts/9b3c91c2.html';
      this.page.title = '目标检测之数据训练';
      };
    // 加载评论内容
    function loadComments () {
      var d = document, s = d.createElement('script');
      s.src = 'https://https-bibichuan-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);

      // 隐藏相关文章
      s.onload = function () {
        var relatedCommon=$('#comments #disqus_recommendations');
        if(relatedCommon){
          relatedCommon.hide();
        }

      }
    }
    function scrollFunction(){
      // offsetTop may changes because of manually resizing browser window or lazy loading images.
          var offsetTop = $('#comments').offset().top - $(window).height();
          var scrollTop = $(window).scrollTop();

          // pre-load comments a bit? (margin or anything else)
          if (offsetTop - scrollTop < 60) {
            $(window).off('scroll',scrollFunction);
            loadComments();
          }
    }
    $(function () {
      if($("#comments").length<=0){
        return;
      }
      var offsetTop = $('#comments').offset().top - $(window).height();
      if (offsetTop <= 0) {
        // load directly when there's no a scrollbar
        loadComments();
      } else {
        $(window).on('scroll', scrollFunction);
      }
    });
  </script>



<script src="/lib/share/iShare.js"></script>
<script type="text/javascript">
var iSharel=(new iShare({container:'.iShare-content',config:{
		title: '这里有精彩的内容，你确定不过来看看吗？链接标题：目标检测之数据训练 链接地址:https://bibichuan.github.io/posts/9b3c91c2.html  |(复制此地址在浏览器中打开)——bibichaun出品。',
		description: '目标检测之数据训练',
		url: 'https://bibichuan.github.io/posts/9b3c91c2.html',
		isAbroad: false,
		isTitle: true,
		initialized: true,
		WXoptions:{
			evenType: 'click',
			isTitleVisibility: true,
			title: '目标检测之数据训练',
			isTipVisibility: true,
			tip: '目标检测之数据训练',
			qrcodeW: '120',
			qrcodeH: '120',
			qrcodeFgc: '#4a148c',
      bgcolor: '#2BAD13'
		}
	}}));
</script>


</body>
</html>