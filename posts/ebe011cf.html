<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OpenVPN之Window端搭建</title>
    <!-- 页面描述 -->
<meta name="description" content=""/>
<!-- 页面关键词 -->
<meta name="keywords" content=""/>
<!-- 网页作者 -->
<meta name="author" content="bibichuan, ibibichuan@gmail.com"/>
<!-- 搜索引擎抓取 -->
<meta name="robots" content="index,follow"/>

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>

<!--禁止百度转码-->
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<!--启用WebApp全屏模式-->
<meta name="apple-mobile-web-app-capable" content="yes" />
<!--禁止数字自动识别为电话号码-->
<meta name="format-detection" content="telephone=no" />
<!--忽略识别邮箱-->
<meta name="format-detection" content="email=no" />
<!--360强制谷歌内核-->
<meta name="renderer" content="webkit"> 

<link rel="icon" href="/images/favicon.ico">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1022896_nclaqhxyt.css">

<link href="/css/main.css" rel="stylesheet" type="text/css" />

<!-- 谷歌广告 -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8382618401389723"></script>


<script type="text/javascript" id="hexo.configurations">
  var BTheme = window.BTheme ||{};
  var CONFIG = {
    root: '/'
  };
</script>

<!--百度统计-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ee4ff785c4c68fa9a0ea17241e0574ea";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!--谷歌统计-->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G4HPTST8XX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-G4HPTST8XX');
</script>

    
    
        
    
        
            
            
            <link href="/lib/layui/css/layui.css" rel="stylesheet" type="text/css" />
        
    

    
        
    

    
        
    


    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.6/dist/jquery.fancybox.min.css" />
<link rel="stylesheet" type="text/css" href="/lib/share/style/css/ishare.css">

<meta name="generator" content="Hexo 5.4.2"></head>
<body class="main">

    <header id="header" class="header layui-fluid">
        <div class="header-inner layui-row"><div class="header-wrap">
    <div class="logo_wrap">
        <a href="/"><img src="/images/logo.png"></a>
    </div>
    <div class='search-warp'>
  <div class="search">
    <input class="search-ipt" placeholder="请输入搜索内容"/>
    <div class="search-btn clear"><i class="iconfont icon-guanbi"></i></div>
    <div class="search-btn find"><i class="iconfont icon-sousuo"></i></div>
  </div>
  <div class="result">
    <ul class="result-content"></ul>
  </div>
</div>
    <div class="icon-menu"><i class="iconfont icon-m_menu"></i></div>
    <nav class="site-nav">
        <ul class="menu layui-nav">
            
            
            <li class="menu-item layui-nav-item">
                <a href="/" rel="section">
                    <i class="iconfont icon-home"></i>首页<i class="iconfont icon-header-mobile icon-right"></i>
                </a>
            </li>
            
            

            
            

            
            
                
                
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/%E6%9D%82%E6%96%87/">
                                    杂文
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Python/">
                                    Python
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Gis/">
                                    Gis
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/Asp/">
                                    Asp
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                        
                        
                            
                            <li class="menu-item layui-nav-item">
                                <a href="/categories/%E8%BD%AF%E4%BB%B6/">
                                    软件
                                    <i class="iconfont icon-header-mobile icon-right"></i>
                                </a>
                            </li>
                        
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                
                <li class="more menu-item layui-nav-item">
                    
                    <a href="javascript:;" class="menu-more">
                        更多分类
                        <i class="iconfont icon-header-mobile icon-sidemenu"></i>
                    </a>
                    
                    <dl class="layui-nav-child">
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Java/">
                                            Java
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%89%8D%E7%AB%AF/">
                                            前端
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Javascript/">
                                            Javascript
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">
                                            数据库
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                                            操作系统
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/Nodejs/">
                                            Nodejs
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">
                                            大数据
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1/">
                                            后台服务
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E9%9A%8F%E7%AC%94/">
                                            随笔
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                            机器学习
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                            
                            
                                
                                
                                    
                                    <dd class="nav-child">
                                        <a href="/categories/%E5%85%B6%E4%BB%96/">
                                            其他
                                            <i class="iconfont icon-header-mobile icon-right"></i>
                                        </a>
                                    </dd>
                                
                            
                        
                    </dl>
                </li>
            
        </ul>
    </nav>
</div></div>
    </header>
    
    <main class="main-content layui-fluid" id="main-content">
      <div class="main-inner">
        
  <div class="layui-row layui-col-space15">
    <div class="layui-col-xs12 layui-col-sm10 layui-col-sm-offset1 layui-col-md6 layui-col-md-offset2 layui-col-lg6 layui-col-lg-offset2">
        <div class="container post_wrap">
          <div class="post">
            <div class="article">
              <h1 class="title">OpenVPN之Window端搭建</h1>
              <div class="author">
                <span class="tag">标签：
                  

                  
                    
                    
                      
                      
                      <a href="/tags/Openvpn/">Openvpn</a>
                    
                  
                </span>
                <span class="tag">分类：
                  

                  
                    
                    
                      
                      
                      <a href="/categories/%E8%BD%AF%E4%BB%B6/">软件</a>
                    
                  
                </span>
                <span class='tag'>
                  创建时间：2021-05-10 08:39:16
                </span>
                <span class='tag'>
                  更新时间：2025-04-28 14:37:40
                </span>
              </div>
              <div class="content">
                <html><head></head><body><h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h2><p>我曾经写过一篇为了科学上网而总结的各种免费和付费的vpn技术(<a href="#">Post not found: 科学上网之VPN 科学上网之VPN</a>),那一片主要用来介绍的是科学上网，还有一篇是<a href="/posts/854ceea5.html" title="Teamviewer自建VPN连接两个网络">Teamviewer自建VPN连接两个网络</a> 是为了从家里的网络，连接到公司的内网中，本篇文章，也是这个主旨，就是为了构建一个虚拟专用网，通过VPN将内网和阿里云的网络连接到一起，成为一个统一的内网系统。</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://help.aliyun.com/product/65234.html?spm=a2c4g.11186623.6.540.f04d59aeEK8jht">VPN网关</a> (阿里云也提供了相应的VPN产品，除了贵一点，其他的都好说啊)<br>2.<a target="_blank" rel="noopener" href="https://zhou-yuxin.github.io/articles/2017/Linux%20%E6%90%AD%E5%BB%BAOpenVPN%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E6%9C%80%E7%AE%80%E9%85%8D%E7%BD%AE/index.html">Linux 搭建OpenVPN服务器和客户端（一）——最简配置</a> (在linux上实现的OpenVPN客户端和服务端)<br>3.<a target="_blank" rel="noopener" href="https://www.softool.cn/blog-91.html">Windows 10 平台搭建 OpenVPN </a><br>4.<a target="_blank" rel="noopener" href="https://www.zhetao.com/content253">WINDOWS+OPENVPN服务器的架设</a><br>5.<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/44795881">Windows防火墙开启ping,禁ping的配置方法</a> (Windows Server 2008中配置Windows防火墙，控制面板–&gt;安全–&gt; Windows防火墙–&gt; 更改设置-&gt;例外 –&gt; 在列表里找到“文件和打印机共享” –&gt; 将前面的勾选中，启用规则)<br>6.<a target="_blank" rel="noopener" href="https://pandavpnpro.com/blog/zh-cn/openvpn">OpenVPN 是什么？【附作用|下载/教程|配置|协议解析等】</a></div>
<h2 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a>1.下载</h2><p>官方给出的<a target="_blank" rel="noopener" href="https://openvpn.net/download-open-vpn/">地址</a>，让我有点懵，就是没有windows版本的下载安装包，有一个Hypery-V的安装包，我觉得两者应该不一样,最后是在社区<a target="_blank" rel="noopener" href="https://openvpn.net/community-downloads/">下载</a>的安装包。</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="http://www.fyluo.com/?post=198">OpenVPN Windows 平台安装部署教程</a> (这篇文章的排版比较好看)</div>
<h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h2><p>有了安装包，双击安装就可可以，但是实际上，比较费事都就是配置。因为是要在Server2008 Standard版本上安装，所以我选择了OpenVPN 2.4.6版本。安装之后，我第一次打开OpenVPN GUI，弹出一个提示，就是使用导入功能，导入一个配置文件，我还是挺懵的，和参考文章中的一点不一样啊。</p>
<img src="/images/loadimg.png" data-original="/posts/ebe011cf/vpn_0.png" lay-src="/posts/ebe011cf/vpn_0.png" class="" title="vpn搭建">

<p>刚开始，我没有找到参考文章中说的那个easy-rsa文件夹，于是我卸载了，又重新安装，才发现，默认的OpenVPN安装界面，没有选中easy-rsa这个选项</p>
<img src="/images/loadimg.png" data-original="/posts/ebe011cf/vpn_1.png" lay-src="/posts/ebe011cf/vpn_1.png" class="" title="vpn搭建">

<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://luanlengli.github.io/2019/11/25/OpenVPN%E5%AE%A2%E6%88%B7%E7%AB%AF-Windows-Linux-MacOS-%E8%BF%9E%E6%8E%A5OpenVPN%E6%9C%8D%E5%8A%A1%E5%99%A8.html">OpenVPN客户端(Windows/Linux/MacOS)连接OpenVPN服务器</a> (<em>.crt、</em>.key、ca.crt证书文件可以内嵌到ovpn文件中，因此有时候会只有一个ovpn文件)<br>2.<a target="_blank" rel="noopener" href="https://my.oschina.net/renyuansoft/blog/14536">Windows下openVPN GUI的安装与配置</a> (和我安装的OpenVPN不一样，我没有C:\Program Files\OPENVPN\easy-rsa\vars.bat.sample 文件)<br>3.<a target="_blank" rel="noopener" href="https://neoserver.site/help/setting-open-vpn-server-windows-server-20082012">Setting up an Open VPN server on Windows Server 2008/2012</a> (在Sever2008中安装和配置OpenVPN,都是英文的)</div>
<h2 id="3-初始化"><a href="#3-初始化" class="headerlink" title="3.初始化"></a>3.初始化</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="string">"C:\Program Files\OpenVPN\easy-rsa"</span></span><br><span class="line">init-config.bat</span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-vars-bat"><a href="#4-vars-bat" class="headerlink" title="4.vars.bat"></a>4.vars.bat</h2><p>编辑C:\Program Files\OpenVPN\easy-rsa\vars.bat文件(linux端的安装路径：/usr/share/easy-rsa/)，多数文章中都是只有下面的一些配置参数,其实还有PKCS11_MODULE_PATH、PKCS11_PIN两个参数，但是具体去查这两个参数的含义，有人说可以忽略。</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> KEY_COUNTRY=US</span><br><span class="line"><span class="built_in">set</span> KEY_PROVINCE=CA</span><br><span class="line"><span class="built_in">set</span> KEY_CITY=SanFrancisco</span><br><span class="line"><span class="built_in">set</span> KEY_ORG=OpenVPN</span><br><span class="line"><span class="built_in">set</span> KEY_EMAIL=mail@host.domain</span><br><span class="line"><span class="built_in">set</span> KEY_CN=changeme</span><br><span class="line"><span class="built_in">set</span> KEY_NAME=changeme</span><br><span class="line"></span><br><span class="line"><span class="comment">## 可以忽略的地方</span></span><br><span class="line"><span class="built_in">set</span> PKCS11_MODULE_PATH=changeme</span><br><span class="line"><span class="built_in">set</span> PKCS11_PIN=1234</span><br></pre></td></tr></tbody></table></figure>

<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://serverfault.com/questions/458440/can-someone-please-explain-easyrsa-vars-options-for-pki-generation">Can someone please explain easyrsa vars options for PKI generation</a> (我猜你使用的是easy-rsa；如果你没有设置这些变量，当你运行工具生成证书时，它会向你询问这些变量。)<br>2.<a target="_blank" rel="noopener" href="https://forum.archive.openwrt.org/viewtopic.php?id=46946">OpenVPN: What are the “PKCS11_MODULE_PATH” and “PKCS11_PIN” variables?</a> (如果你不需要PKCS11_MODULE_PATH、PKCS11_PIN这些参数，可以忽略)</div>
<h2 id="5-执行清理任务"><a href="#5-执行清理任务" class="headerlink" title="5.执行清理任务"></a>5.执行清理任务</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="string">"C:\Program Files\OpenVPN\easy-rsa"</span></span><br><span class="line">vars.bat</span><br><span class="line">clean-all.bat</span><br></pre></td></tr></tbody></table></figure>

<p>进入到easy-rsa目录，以后所有的命令行操作，都在这个目录中运行。这样初始化工作就结束了，以后需要执行vars.bat命令，才能继续生成客户端和服务端密钥。</p>
<h2 id="6-生成根证书"><a href="#6-生成根证书" class="headerlink" title="6.生成根证书"></a>6.生成根证书</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">build-ca.bat</span><br><span class="line"></span><br><span class="line"><span class="comment">## 生成密钥</span></span><br><span class="line">build-dh.bat</span><br></pre></td></tr></tbody></table></figure>

<p>根据出现的提示，您只需按Enter。唯一的例外是KEY_CN（公用名）字段-请确保指定一个唯一的名称，并在“名称”字段中插入相同的名称：</p>
<h2 id="7-生成服务端密钥"><a href="#7-生成服务端密钥" class="headerlink" title="7.生成服务端密钥"></a>7.生成服务端密钥</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\build-key-server.bat server</span><br></pre></td></tr></tbody></table></figure>

<p>现在将询问所有生成的密钥，是否代表证书颁发机构对生成的证书进行签名（对证书签名）。回答y（是）。</p>
<h2 id="8-生成客户端密钥"><a href="#8-生成客户端密钥" class="headerlink" title="8.生成客户端密钥"></a>8.生成客户端密钥</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\build-key.bat client1</span><br></pre></td></tr></tbody></table></figure>

<p>在“通用名称”字段中，指定客户端的名称（在我们的示例中为client1）。</p>
<h2 id="9-复制文件"><a href="#9-复制文件" class="headerlink" title="9.复制文件"></a>9.复制文件</h2><p>(1) 生成的证书位于C：\ Program Files \ OpenVPN \ easy-rsa \ keys目录中,将下面列出的文件复制到目录C：\ Program Files \ OpenVPN \ config 文件夹中。</p>
<ul>
<li>ca.crt</li>
<li>dh2048.pem/dh1048.pem</li>
<li>server.crt</li>
<li>server.key</li>
</ul>
<p>(2) 默认配置文件在：C:\Program Files\OpenVPN\sample-config中，将下面列出的文件复制到目录C：\ Program Files \ OpenVPN \ config 文件夹中。</p>
<ul>
<li>server.ovpn</li>
<li>client.ovpn</li>
</ul>
<h2 id="10-修改服务端配置"><a href="#10-修改服务端配置" class="headerlink" title="10.修改服务端配置"></a>10.修改服务端配置</h2><p>打开C：\ Program Files \ OpenVPN \ config\service.ovpn文件，修改下面的内容：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">port 443                                                     <span class="comment"># 端口号，根据需要，自行修改，如果是用http代理连接，请不要修改</span></span><br><span class="line">proto tcp-server</span><br><span class="line">dev tun</span><br><span class="line">server 10.0.0.0 255.255.255.0                                <span class="comment"># 虚拟局域网网段设置，请根据需要自行修改  </span></span><br><span class="line">keepalive 20 180</span><br><span class="line">ca <span class="string">"C:\\Program Files\\OpenVPN\\config\\ca.crt"</span>                   <span class="comment">#CA证书存放位置，请根据实际情况自行修改</span></span><br><span class="line">cert <span class="string">"C:\\Program Files\\OpenVPN\\config\\server.crt"</span>             <span class="comment">#服务器证书存放位置，请根据实际情况自行修改</span></span><br><span class="line">key <span class="string">"C:\\Program Files\\OpenVPN\\config\\server.key"</span>              <span class="comment">#服务器密钥存放位置，请根据实际情况自行修改</span></span><br><span class="line">dh <span class="string">"C:\\Program Files\\OpenVPN\\config\\dh2048.pem"</span>             <span class="comment">#dh1024.pem存放位置，请根据实际情况自行修改</span></span><br><span class="line">push <span class="string">"redirect-gateway def1"</span></span><br><span class="line">push <span class="string">"dhcp-option DNS 223.5.5.5"</span>                         <span class="comment">#DNS，请根据实际情况自行修改</span></span><br><span class="line">mode server                                                  <span class="comment">## 没有就新键一行</span></span><br><span class="line">tls-server                                                   <span class="comment">## 没有就新键一行</span></span><br><span class="line">status <span class="string">"C:\\Program Files\\OpenVPN\\log\\openvpn-status.log"</span>   <span class="comment">#LOG记录文件存放位置，请根据实际情况自行修改</span></span><br><span class="line">comp-lzo                                                     <span class="comment">## 将前面的分号去掉</span></span><br><span class="line">verb 4                                                       <span class="comment">## 将前面的分号去掉</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="11-客户端安装"><a href="#11-客户端安装" class="headerlink" title="11.客户端安装"></a>11.客户端安装</h2><p>客户端安装OpenVPN软件，然后复制以下文件<br>(1) 将服务器生成的客户端密钥ca.crt client1.crt client1.key三个文件，复制到客户端的C:\Program Files\OpenVPN\config文件夹中。</p>
<p>(2) 复制客户端的C:\Program Files\OpenVPN\sample-config\client.ovpn到C:\Program Files\OpenVPN\config文件夹。</p>
<h2 id="12-修改客户端配置文件"><a href="#12-修改客户端配置文件" class="headerlink" title="12.修改客户端配置文件"></a>12.修改客户端配置文件</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dev tun</span><br><span class="line">proto tcp-client</span><br><span class="line">remote www.oovc.com 443                #服务器域名/IP 和端口</span><br><span class="line">resolv-retry infinite</span><br><span class="line">nobind</span><br><span class="line">http-proxy 192.168.1.1 80                  #这里填入你的代理服务器地址和端口,没有代理可以不填</span><br><span class="line">mute-replay-warnings</span><br><span class="line">ca "C:\\Program Files\\OpenVPN\\config\\ca.crt"</span><br><span class="line">cert "C:\\Program Files\\OpenVPN\\config\\client241.crt"         #这里改成每个客户端相应的证书</span><br><span class="line">key "C:\\Program Files\\OpenVPN\\config\\client241.key"          #这里改成每个客户端相应的密钥</span><br><span class="line">comp-lzo</span><br><span class="line">verb 4</span><br><span class="line">status "C:\\Program Files\\OpenVPN\\log\\openvpn-status.log"</span><br></pre></td></tr></tbody></table></figure>

<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://wanglu.info/2015/11/1010.html">OpenVPN客户端配置</a></div>
<h2 id="13-连接"><a href="#13-连接" class="headerlink" title="13.连接"></a>13.连接</h2><p>打开OpenVPN GUI，然后在右下角的图标中右键选择连接。在连接时需要注意以下几点：<br>(1) 客户端的remote是否配置正确,端口号，网络地址是否能通过端口扫描。<br>(2) 客户端的proto是否和服务器配置一致，最好是tcp协议，因为使用udp，我没有成功。</p>
<p>如果还是有问题，请参考下面几个问题总结。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>(1) –cipher set to ‘AES-256-CBC’ but missing in –data-ciphers (AES-256-GCM:AES-128-GCM). Future OpenVPN version will ignore –cipher for cipher negotiations. Add ‘AES-256-CBC’ to –data-ciphers or change –cipher ‘AES-256-CBC’ to –data-ciphers-fallback ‘AES-256-CBC’ to silence this warning</p>
<p>服务器是OpenVPN 2.4,客户端时是2.5，换成一样的版本尝试。</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://www.reddit.com/r/PrivateInternetAccess/comments/j1iyl7/openvpn_client_no_longer_connects_cipher_not/">OpenVPN client no longer connects, cipher not recognized and missing in –data-ciphers</a> (You’re using OpenVPN 2.5 which ONLY allows AES-256-GCM AES-128-GCM by default. The config files provided by PIA only set up CBC ciphers.You need to either fall back to OpenVPN 2.4, or follow the directions in the error message and change your configuration and explicitly enable the CBC ciphers.)</div>
<p>(2) –tls-auth fails with ‘ta.key’: No such file or directory (errno=2)</p>
<p>有两种解决方法，找到客户端的client.ovpn文件，将其中的 tls-auth注释掉，</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tls-auth ta.key 1</span></span><br></pre></td></tr></tbody></table></figure>

<p>或者是生成ta.key文件，然后指定ta.key的位置(这个我没试)</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openvpn --genkey --secret /etc/openvpn/easy-rsa/keys/ta.key</span><br></pre></td></tr></tbody></table></figure>

<div class="reference">参考文章：<br>1.<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/359428/open-vpn-options-error-tls-auth-fails-with-ta-key-no-such-file-or-director">Open VPN options error: –tls-auth fails with ‘ta.key’: no such file or directory</a> (drop the tls-auth instruction altogether. This is not a major dent in your security: the Manual in fact states)</div>
<p>(3) TLS Error: TLS key negotiation failed to occur within 60 seconds (check your network connectivity)<br>我尝试了用端口扫描工具，扫描阿里云的端口开放程度，发现1194端口没有开放，但是在查询进程的时候，发现1194端口已经由openvpn.exe在使用了。</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 查看端口进程</span></span><br><span class="line">netstat -aon|findstr <span class="string">"1194"</span></span><br><span class="line"><span class="comment">## 查看进程号所代表的程序</span></span><br><span class="line">tasklist|findstr <span class="string">"21004"</span></span><br></pre></td></tr></tbody></table></figure>

<p>我将防护墙关闭，重新扫描端口开启，还是出现了关闭问题。</p>
<p>我在阿里云的安全组中，将端口加入进去，还是出现了问题。</p>
<p><strong>解决方法</strong></p>
<p>最后，我将server端的proto改为了tcp模式，配置的阿里云安全组以及防火墙都生效了，然后将客户端的proto和remote改为服务器的相应配置，最后实现了openvpn连接</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://openvpn.net/faq/tls-error-tls-key-negotiation-failed-to-occur-within-60-seconds-check-your-network-connectivity/">TLS Error: TLS key negotiation failed to occur within 60 seconds (check your network connectivity)</a> (这里几条情况，说明可能是由于网络不通)<br>2.<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1455991">Windows下查看端口占用情况</a><br>3.<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/25471.html">添加安全组规则</a></div>
<p>(4) openvpn all tap-windows adapters on this system are currently in use</p>
<p>解决方式一:禁用，再启用<br>在windows 2008上，打开网络和共享中心-&gt;管理网络连接,找到TAP-Windows Adaper，先右键禁用，然后再启用。</p>
<p>解决方式二:重新安装<br>C:\Program Files\TAP-Windows,卸载，然后重新安装。</p>
<p>这两个方案我都尝试过了，没有重启电脑，都不行。</p>
<p><strong>解决方法</strong><br><strong>最后解决方法，就是在系统服务中，将我启动的OpenVPNService和OpenVPN Legacy Service两个服务停掉，就可以了。</strong></p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://vpn.ac/knowledgebase/64/OpenVPN-Error-All-TAP-Windows-adapters-on-this-system-are-currently-in-use.html">OpenVPN Error: All TAP-Windows adapters on this system are currently in use</a><br>2.<a target="_blank" rel="noopener" href="https://www.thewindowsclub.com/tap-windows-adapters-are-currently-in-use">All TAP-Windows adapters on this system are currently in use</a> (也是上面提供的两种方式进行修复)</div>
<p>(5) –explicit-exit-notify can only be used with –proto udp<br>当我配置proto tcp的时候，弹出这个错误，只能用udp。</p>
<p>解决方法:把server.ovpn中的：explicit-exit-notify 1,注释掉。</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://serverfault.com/questions/457047/openvpn-doesnt-works-with-tcp">OpenVPN doesn’t works with TCP</a></div>
<h2 id="14-端口转发"><a href="#14-端口转发" class="headerlink" title="14.端口转发"></a>14.端口转发</h2><p>(1) 在我成功将内外网联通之后，服务器的ip为：10.0.0.1，客户端的ip为：10.0.0.6。我执行了ping操作，从客户端ping服务端，以及从服务端ping客户端都可以访问。</p>
<p>(2) 另外，我在客户端安装了hmailserver服务器，开放了25和110端口，我使用telnet 10.0.0.6 25 在客户端上查看端口是否开放，发现有回应，也就是说客户端的邮件服务器正常运行。但是在服务器端同样尝试这个命令，却没有回应，说明服务器和客户端没有联通。</p>
<p>(3) 同样的，我在服务端开启了3306端口以及9201端口，在客户端使用：telnet 10.0.0.1 9201，以及telnet 10.0.0.1 3306，都可以连接上,也就是说，只能一方通行,从客户端可以访问服务端，但是无法从服务端访问客户端。</p>
<p>(4) 为了测试，我使用teamviewer提供的vpn选项连接了内外网，在服务器端使用telnet查看安装了邮件服务器的客户端25端口时，也有了正确的回应，问题就是出在了openvpn的设置中。但是根据telnet的说明：</p>
<pre><code>If the port is Open, you will see a blank screen. This means that the connection is successful.(如果端口开放了，你将会看到一个黑屏，意味着你已经连接成功了。)
If the port is closed, you will receive a Connect failed message. (如果端口没有开放，你将收到一个连接失败的提示)
</code></pre>
<p>所以我在服务端，随便测试一个端口：telnet 10.0.0.6 89,确实不通，也就是说，25端口开放了，但是没有回应任何信息。</p>
<p>(5) 在内网openvpn客户端有一个80端口，部署了IIS网站，在openvpn服务端可以直接输入在浏览器地址栏中输入：10.0.0.6 访问客户端的网站。</p>
<div class="reference">参考文章:<br>1.<a target="_blank" rel="noopener" href="https://shawn-ji.github.io/2017/06/02/openvpn.html">openvpn实现内网 映射到 外网</a> (先是在linux系统上创建了openvpn链接了内外网，然后是使用了iptables进行了端口转发)<br>2.<a target="_blank" rel="noopener" href="https://atxiu.github.io/OpenVPN.html">OpenVPN搭建管道为内网地址映射公网端口</a><br>3.<a target="_blank" rel="noopener" href="https://www.ilanni.com/?p=9877">烂泥：openvpn tun模式下客户端与内网机器通信</a><br>4.<a target="_blank" rel="noopener" href="https://www.daimajiaoliu.com/daima/3857b7946100402">利用云服务器通过OpenVPN将内网的地址发布到外网</a> (除了介绍了端口转发之外，还介绍了如何搭建openvpn连接虚拟专用网)<br>5.<a target="_blank" rel="noopener" href="https://support.n4l.co.nz/s/article/How-to-use-Telnet-to-Check-the-Status-of-Ports">ArticlesHow to use Telnet (to Check the Status of Ports)</a> (如何判读是否连接成功)</div></body></html>
              </div>
            </div>
          </div>
          <div class='post-footer'>
            <div>**本文已结束，感谢您的观看**</div>
            <div class="btn btn-pay">鼓励一下</div>
          </div>
          
            <div class="page">
              
              <section class="past-wrap">
                <section class="past">
                <p>往期推荐</p>
                </section>
              </section>
              <div class="post-nav">
                <div class="post-nav-next post-nav-item">
                  
                    <a href="/posts/61fe8459.html" rel="next" title="OpenVPN之高可用集群">
                      <i class="iconfont icon-prev"></i> OpenVPN之高可用集群
                    </a>
                  
                </div>

                <span class="post-nav-divider"></span>

                <div class="post-nav-prev post-nav-item">
                  
                    <a href="/posts/77cc9d04.html" rel="prev" title="OpenVPN之MacOS端搭建">
                      OpenVPN之MacOS端搭建 <i class="iconfont icon-next"></i>
                    </a>
                  
                </div>
              </div>
            </div>
          
          
 <div class="comments" id="comments">
    <div id="disqus_thread">
        <noscript>
            不支持Javascript,那你还上啥网啊。
            <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript"></a>
        </noscript>
    </div>
</div>

      </div>
    </div>


    <div class="layui-col-md2 layui-col-lg2 layui-col-sm10 layui-col-xs12 catalogue-wrap">
        

<div class="catalogue-content">
    <div class="title">文章目录</div>
    <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">1.前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.</span> <span class="toc-text">1.下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">2.安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">4.</span> <span class="toc-text">3.初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-vars-bat"><span class="toc-number">5.</span> <span class="toc-text">4.vars.bat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%89%A7%E8%A1%8C%E6%B8%85%E7%90%86%E4%BB%BB%E5%8A%A1"><span class="toc-number">6.</span> <span class="toc-text">5.执行清理任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%94%9F%E6%88%90%E6%A0%B9%E8%AF%81%E4%B9%A6"><span class="toc-number">7.</span> <span class="toc-text">6.生成根证书</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%94%9F%E6%88%90%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AF%86%E9%92%A5"><span class="toc-number">8.</span> <span class="toc-text">7.生成服务端密钥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%94%9F%E6%88%90%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%86%E9%92%A5"><span class="toc-number">9.</span> <span class="toc-text">8.生成客户端密钥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">10.</span> <span class="toc-text">9.复制文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">11.</span> <span class="toc-text">10.修改服务端配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E8%A3%85"><span class="toc-number">12.</span> <span class="toc-text">11.客户端安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E4%BF%AE%E6%94%B9%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">12.修改客户端配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E8%BF%9E%E6%8E%A5"><span class="toc-number">14.</span> <span class="toc-text">13.连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">15.</span> <span class="toc-text">问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">16.</span> <span class="toc-text">14.端口转发</span></a></li></ol>
    </div>
</div>


        <div class="sidecontent">

    

    <div class="side-panel side-sponsor">
        <div class="side-title one">小额赞助</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">本人提供免费与付费咨询服务，感谢您的支持！赞助请发邮件通知，方便公布您的善意！</div>
                <div class="content">
                    <img src="/images/pay.png" title="小额赞助"/>
                </div>
                
                
                <div class="donor_content">
                    
                        
                        <div class="donor-item">
                            <span class="name">**光</span>
                            <span class="money">3.01 元</span>
                        </div>
                    
                        
                        <div class="donor-item">
                            <span class="name">Sun</span>
                            <span class="money">3.00 元</span>
                        </div>
                    
                        
                        <div class="donor-item">
                            <span class="name">bibichuan</span>
                            <span class="money">3.00 元</span>
                        </div>
                    
                    <div class="donor_footer">
                        <span>捐赠者名单</span>
                        <span class="total">合计：9.01 元</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-ad side-panel">
        <div class="side-title two">微信公众号</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <img src="/images/wechat.png" title="公众号"/>
            </div>
        </div>
    </div>

    <div class="side-ad side-panel">
        <div class="side-title one">广告位</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">诚心邀请广大金主爸爸洽谈合作</div>
                <div class="detail">
                </div>
            </div>
        </div>
    </div>

    <div class="side-ask side-panel">
        
        <div class="side-title two">每日一省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">isNaN 和 Number.isNaN 函数的区别？</div>
                <div class="detail">
                    
                        <p>1.函数 isNaN 接收参数后，会尝试将这个参数转换为数值，任何不能被转换为数值的的值都会返回 true，因此非数字值传入也会返回 true ，会影响 NaN 的判断。</p>
                    
                        <p>2.函数 Number.isNaN 会首先判断传入参数是否为数字，如果是数字再继续判断是否为 NaN ，不会进行数据类型的转换，这种方法对于 NaN 的判断更为准确。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title three">每日二省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">为什么0.1+0.2 ! == 0.3，如何让其相等?</div>
                <div class="detail">
                     
                        <p>一个直接的解决方法就是设置一个误差范围，通常称为“机器精度”。对JavaScript来说，这个值通常为2-52，在ES6中，提供了Number.EPSILON属性，而它的值就是2-52，只要判断0.1+0.2-0.3是否小于Number.EPSILON，如果小于，就可以判断为0.1+0.2 ===0.3。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230#heading-8"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title three">每日三省</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">== 操作符的强制类型转换规则？</div>
                <div class="detail">
                     
                        <p>1.首先会判断两者类型是否**相同，**相同的话就比较两者的大小。</p>
                    
                        <p>2.类型不相同的话，就会进行类型转换。</p>
                    
                        <p>3.会先判断是否在对比 null 和 undefined，是的话就会返回 true。</p>
                    
                        <p>4.判断两者类型是否为 string 和 number，是的话就会将字符串转换为 number。</p>
                    
                        <p>5.判断其中一方是否为 boolean，是的话就会把 boolean 转为 number 再进行判断。</p>
                    
                        <p>6.判断其中一方是否为 object 且另一方为 string、number 或者 symbol，是的话就会把 object 转为原始类型再进行判断。</p>
                    
                </div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2021-04-07</span>
                
                    <span class="side-footer-item side-button down" title="查看答案">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                
                    <a class="side-footer-item side-button answer-url" href="https://juejin.cn/post/6940945178899251230#heading-12"
                    target="_blank">链接地址</a>
                
            </div>
        </div>
    </div>
    <div class="side-ask side-panel">
        
        <div class="side-title two">每日英语</div>
        <div class="side-content-wrap">
            <div class="side-content">
                <div class="heading">Happiness is time precipitation, smile is the lonely sad.</div>
                <div class="detail">幸福是年华的沉淀，微笑是寂寞的悲伤。</div>
            </div>
            <div class="side-footer">
                <span class="side-footer-item time">2016</span>
                
                    <span class="side-footer-item side-button down" title="查看翻译">
                        <i class="iconfont icon-expansion"></i>
                    </span>
                
                <span class="side-footer-item author">——— 美文</span>
            </div>
        </div>
    </div>

</div>
    </div>

  </div>
  <div class="side-tool">
    <div class="side-icon-wrap">
        <i class="iconfont icon-sidemenu"></i>
    </div>
    <ul class="side-tool-content">
        <li title="回到顶部" class="back-to-top side-tool-item">
            <a class="function-button"><i class="iconfont icon-backtop"></i></a>
        </li> 
        <li title="分享文章" class="side-share side-tool-item">
            <a class="function-button"><i class="iconfont icon-share"></i></a>
            <div class="iShare iShare-content"></div>
        </li>
        <li title="喜欢文章" class="side-like side-tool-item">
            <a class="function-button"><i class="iconfont icon-like"></i></a>
        </li>
         <li class="side-close" title="关闭侧边栏">
            <a class="function-button"><i class="iconfont icon-close"></i></a>
        </li>
    </ul>
</div>

      </div>
    </main>   
    
    <footer id="footer" class="footer layui-fluid">
      <div class="layui-row">
        <div class="container footer-inner">
          <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="footer-col">
  <div>温馨提示</div>
  <div><a href="/about" target="_self">关于作者</a></div>
  <div><a href="/archives">博客归档</a></div>
  <div>
    <span id="busuanzi_container_site_uv">
      访客数<span id="busuanzi_value_site_uv"></span>人次
    </span>
  </div>
</div>
<div class="footer-col">
  <div>友情链接</div>
  
  
  
  
    
        <div><a href="https://malagis.com" target="_blank">麻辣GIS</a></div>
    
  
    
        <div><a href="https://www.giserdqy.com" target="_blank">GIS开发者</a></div>
    
  
    
        <div><a href="https://earth.nullschool.net/zh-cn/" target="_blank">earth.nullschool</a></div>
    
  
    
        <div><a href="https://www.gisclouder.com/" target="_blank">码上GIS实现的热力图</a></div>
    
  
    
        <div><a href="http://www.cnblogs.com/naaoveGIS/" target="_blank">李晓辉的博客园</a></div>
    
  
    
        
          <div><a href="/links">更多</a></div>
          
        
    
  
    
        
    
  
    
        
    
  
    
        
    
  
  <div class="chain-msg">**注意：以上网站都没给钱**</div>
</div>
<div class="footer-col">
  <div>精彩推荐</div>
  
    <div><a href="/study">励志</a></div>
  
    <div><a href="/anime">动漫</a></div>
  
    <div><a href="/movie">电影</a></div>
  
    <div><a href="/tv">电视</a></div>
  
    <div><a href="/book">书籍</a></div>
  
</div>
<div class="footer-col">
  <div>开源项目</div>
  
    <div><a href="/"></a></div>
  
</div>
          
        </div>
      </div>
    </footer>

    


<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>

    
        
            
            
            <script type="text/javascript" src="/lib/layui/layui.js"></script>
        
    
        
    

    
        
            
            
                
            
            <script type="text/javascript" src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
        
    

    
        
            
            
            <script type="text/javascript" src="/lib/jquery.actual.min.js"></script>
        
    


    


  <script type="text/javascript" src="/js/src/utils.js?v="></script>



    
      <script type="text/javascript" src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearchLite.min.js"></script>
<script type="text/javascript">
  var client = algoliasearch('DM9LMZOGZE', '1c2739694b8acb4c4edab8ccb098d166');
  var index = client.initIndex('bibichuan');
  $(document).ready(function(){
    var $search=$(".header-wrap");
    var $searchbtn= $search.find(".find");
    var $ipt=$search.find(".search-ipt");
    var $resultClear=$search.find(".clear");
    var $result=$search.find(".result");
    // 加入layui
    layui.use('layer', function(){
      var layer = layui.layer;
      // 搜索按钮点击
      $searchbtn.on("click",function(){
        var text=$ipt.val();
        var $this=$(this);
        var $resultContent=$result.find(".result-content");
        if(text){
          var loadDialog=layer.load();
          if(!$this.hasClass("disabled")){
            $this.addClass("disabled");
            index.search(text, (err, { hits } = {}) => {
              layer.close(loadDialog); 

              $this.removeClass("disabled");
              var resultHtml="";
              // 命中
              if(hits.length>0){
                var count=hits.length;
                for(var i=0;i<count;i++){
                  var h=hits[i];
                  //根据返回值中_highlightResult来判断显示的内容。
                  var content=h.contentStripTruncate;
                  var _highlight=h._highlightResult;

                  var resultC="";
                  var hitType=""; // 命中的类型
                  //标题命中
                  if(_highlight.title&&!resultC){  
                    if(_highlight.title.matchLevel&&_highlight.title.matchLevel!='none'){
                      resultC=_highlight.title.value;
                      hitType="title";
                    }
                  }
                  //分类命中
                  if(_highlight.categories&&!resultC){ 
                    var arr=_highlight.categories;
                    if(arr instanceof Array){
                      var countTemp=arr.length;
                      for(var j=0;j<countTemp;j++){
                        var temp=arr[j];
                        if(temp.matchLevel&&temp.matchLevel!='none'){
                          resultC=temp.value;
                          hitType="categories";
                        }
                      }
                    }else{
                      if(arr.matchLevel&&arr.matchLevel!='none'){
                        resultC=arr.value;
                        hitType="categories";
                      }
                    }
                  }

                  //标签命中
                  if(_highlight.tags&&!resultC){ 
                    var arr=_highlight.tags;
                    if(arr instanceof Array){
                      var countTemp=arr.length;
                      for(var j=0;j<countTemp;j++){
                        var temp=arr[j];
                        if(temp.matchLevel&&temp.matchLevel!='none'){
                          resultC=temp.value;
                          hitType="tags";
                        }
                      }
                    }else{
                      if(arr.matchLevel&&arr.matchLevel!='none'){
                        resultC=arr.value;
                        hitType="tags";
                      }
                    }
                  }

                  // 内容命中
                  if(!resultC){ 
                    resultC=_highlight.contentStripTruncate.value;
                    hitType="contentStripTruncate";
                  }

                  //如果内容过长，则截断
                  if(resultC.length>50){
                    var index=resultC.indexOf('<em>');
                    var blockIndex=10;
                    if(index>=blockIndex){
                      index=index-blockIndex;
                    }else{
                      index=0;
                    }
                    resultC="..."+resultC.substring(index,index+20+blockIndex)+"...";
                  }
                  switch(hitType){
                    case "title":
                      resultC="标题："+resultC;
                      break;
                    case "categories":
                      resultC="分类："+resultC;
                      resultC+=" ("+h.contentStripTruncate.substring(0,40)+"...)";
                      break;
                    case "tags":
                      resultC="标签："+resultC;
                      resultC+=" ("+h.contentStripTruncate.substring(0,40)+"...)";
                      break;
                    case "contentStripTruncate":
                      resultC="内容："+resultC;
                      break;
                  }

                  resultHtml+='<li class="result-item" title="'+content+'"><a href="'+h.permalink+'">'+resultC+'</a></li>';
                }
                $(resultHtml).appendTo($resultContent.empty());
                $result.show();
                $resultClear.show();
              }else{
                var resultHtml='<li class="result-item" title="未找到相关内容"><a>未找到相关内容</a></li>';
                $(resultHtml).appendTo($resultContent.empty());
                $result.show();
                $resultClear.show();
              }
            });
          }
        }else{
          layer.msg("请输入搜索内容");
        }
      });
      // 删除输入内容
      $resultClear.on("click",function(){
        $result.hide();
        $resultClear.hide();
        //清空输入内容
        $ipt.val("");
      });
      // 监听确定事件
      $ipt.keydown(function(e){
        if(e.keyCode==13){
          $searchbtn.click();
        }
      });
    });              
  
  });
</script>
    

    
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.6/dist/jquery.fancybox.min.js"></script>
<script src="/js/src/post/post.js">></script>

  

  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'https://bibichuan.github.io/posts/ebe011cf.html';
      this.page.identifier = 'posts/ebe011cf.html';
      this.page.title = 'OpenVPN之Window端搭建';
      };
    // 加载评论内容
    function loadComments () {
      var d = document, s = d.createElement('script');
      s.src = 'https://https-bibichuan-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);

      // 隐藏相关文章
      s.onload = function () {
        var relatedCommon=$('#comments #disqus_recommendations');
        if(relatedCommon){
          relatedCommon.hide();
        }

      }
    }
    function scrollFunction(){
      // offsetTop may changes because of manually resizing browser window or lazy loading images.
          var offsetTop = $('#comments').offset().top - $(window).height();
          var scrollTop = $(window).scrollTop();

          // pre-load comments a bit? (margin or anything else)
          if (offsetTop - scrollTop < 60) {
            $(window).off('scroll',scrollFunction);
            loadComments();
          }
    }
    $(function () {
      if($("#comments").length<=0){
        return;
      }
      var offsetTop = $('#comments').offset().top - $(window).height();
      if (offsetTop <= 0) {
        // load directly when there's no a scrollbar
        loadComments();
      } else {
        $(window).on('scroll', scrollFunction);
      }
    });
  </script>



<script src="/lib/share/iShare.js"></script>
<script type="text/javascript">
var iSharel=(new iShare({container:'.iShare-content',config:{
		title: '这里有精彩的内容，你确定不过来看看吗？链接标题：OpenVPN之Window端搭建 链接地址:https://bibichuan.github.io/posts/ebe011cf.html  |(复制此地址在浏览器中打开)——bibichaun出品。',
		description: 'OpenVPN之Window端搭建',
		url: 'https://bibichuan.github.io/posts/ebe011cf.html',
		isAbroad: false,
		isTitle: true,
		initialized: true,
		WXoptions:{
			evenType: 'click',
			isTitleVisibility: true,
			title: 'OpenVPN之Window端搭建',
			isTipVisibility: true,
			tip: 'OpenVPN之Window端搭建',
			qrcodeW: '120',
			qrcodeH: '120',
			qrcodeFgc: '#4a148c',
      bgcolor: '#2BAD13'
		}
	}}));
</script>


</body>
</html>